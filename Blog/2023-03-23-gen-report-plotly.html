<!DOCTYPE html>
<html><head><title>Generate Single Page HTML Data Report Using Plotly in Python</title><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Generate Single Page HTML Data Report Using Plotly in Python"/><meta property="og:description" content="Someone said: the best way to write a blog is not just describe waht you did, but how you resolve a problem, to record how do you think about that at that moment."/><meta property="og:image" content="https://quartz.19960312.xyz/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="Someone said: the best way to write a blog is not just describe waht you did, but how you resolve a problem, to record how do you think about that at that moment."/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=Roboto Mono&amp;family=Noto Serif SC:wght@400;700&amp;family=Noto Serif SC:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Blog/2023-03-23-gen-report-plotly"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="..">üòÑ Joker's Digital Garden</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Light mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Dark mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="recent-notes desktop-only"><h3>Recent</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Travels/Travels" class="internal">1970~2023</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Readings/Videos/Videos" class="internal">Videos</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Readings/Papers/Papers" class="internal">Papers</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Knowledges/UsefulSnipets/Nvme-Device-Operation-cmds" class="internal">Nvme Device Operation cmds</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Knowledges/How-to-check-the-binding-glibc-version-of-a-binary" class="internal">How to check the binding glibc version of a binary</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li></ul><p><a href="../tags">See 107 more ‚Üí</a></p></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href="../Blog/">Blog</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href>Generate Single Page HTML Data Report Using Plotly in Python</a></div></nav><h1 class="article-title">Generate Single Page HTML Data Report Using Plotly in Python</h1><p class="content-meta">Apr 14, 2023, 5 min read</p><ul class="tags"><li><a href="../tags/technology" class="internal tag-link">#technology</a></li><li><a href="../tags/data_visualization" class="internal tag-link">#data_visualization</a></li></ul><div class="recent-notes mobile-only"><h3>Recent</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Travels/Travels" class="internal">1970~2023</a></h3></div><p class="meta">Mar 04, 2024</p><ul class="tags"></ul></div></li></ul><p><a href="../tags">See 111 more ‚Üí</a></p></div></div></div><article class="popover-hint"><blockquote>
<p>Someone said: the best way to write a blog is not just describe waht you did, but how you resolve a problem, to record how do you think about that at that moment.</p>
</blockquote>
<blockquote>
<p>I agree with this.</p>
</blockquote>


<h1 id="background---requirements-definination">Background  &amp; Requirements Definination<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#background---requirements-definination" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>We often need to generate some data reports, a typical senario is we got some data, and we want to generate a single page data report, so in this blog I will describe how to generate single page HTML data report using open source library Plotly in python.</p>
<h2 id="requirements-clearify">Requirements Clearify:<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#requirements-clearify" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li>the input is processed data, as an example, we assume that it is a combination of tabular data, time series data and barchart data;</li>
<li>we should generate charts one-by-one for each data source, and put them all into a single HTML file;</li>
<li>this is a tool component, we need to integrate it with other software, wo make the integration easier, make it self-contained is a good choice, that means the output file can be accessed in offline environment.</li>
</ol>
<h1 id="implementation">Implementation<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#implementation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="write-the-interface-and-testcase-first">Write the Interface and Testcase First<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#write-the-interface-and-testcase-first" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>TDD( Test Driven Developing ) is always a good practice in software developing, according to the TDD work flow, we should write the interface and test case first.</p>
<p>First, let‚Äôs build the project structure like this:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-dark github-light"><code data-language="bash" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">.</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">‚îú‚îÄ‚îÄ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> Makefile</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">‚îú‚îÄ‚îÄ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> plotly_offline_report</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">‚îÇ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">   ‚îú‚îÄ‚îÄ gen_report.py</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">‚îÇ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">   ‚îú‚îÄ‚îÄ __init__.py</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">‚îî‚îÄ‚îÄ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> tests</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    ‚îú‚îÄ‚îÄ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> __init__.py</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    ‚îî‚îÄ‚îÄ</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> test_gen_report.py</span></span></code></pre></figure>
<p>In <code>gen_report.py</code>, we define the structure ReportData as the source data of the report,  and the function <code>gen_report()</code> to finish the report generating, we are not planning to implement it in this stage, so the function body is empty.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-dark github-light"><code data-language="python" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ReportData</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    tabular_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> None</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    time_series_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    bar_chart_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ReportGenerator</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  </span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> __init__</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self, report_data, report_filename):</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> report_data</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_filename </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> report_filename</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> gen_report_file</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">		pass</span></span></code></pre></figure>
<p>In <code>test_gen_report.py</code>, we implement the GenReport Testcase, the testcase described what we need to do is get the report data  and call the gen_report() function on the report data to geneate a report file. The report file will be stored in the <code>TMP_DIR</code>, and we can use <code> python3 -m http.server --directory /tmp/plotly_gen_report/</code> to start a webserver on the directory, so we can easily open browser to check if it fullfilled our requirments mannually, TDD workflow makes the dev-test loop faster and accelerates the development.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-dark github-light"><code data-language="python" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> unittest</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> tempfile</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> os</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> random</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> plotly_offline_report.gen_report </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> ReportGenerator, ReportData</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">TMP_DIR</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;/tmp/plotly_gen_report&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> TestGenReport</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">unittest</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">TestCase</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">):</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> setUp</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self) -> </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">None</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        if</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> not</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (os.path.exists(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">TMP_DIR</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">and</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> os.path.isdir(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">TMP_DIR</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)):</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">            os.mkdir(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">TMP_DIR</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> test_gen_report</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        report_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> ReportData()</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        report_data.tabular_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;test_header&quot;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> for</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> i </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">in</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> range</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">10</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)]]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        report_data.tabular_data.extend(</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">            [[random.randint(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">100</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">for</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> i </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">in</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> range</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">10</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">for</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> j </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">in</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> range</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        )</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        report_data.bar_chart_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [(i, random.randint(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">100</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">for</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> i </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">in</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> range</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">10</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        report_data.time_series_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [random.randint(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">100</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">for</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> i </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">in</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> range</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1000</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        test_report_file </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> tempfile.NamedTemporaryFile(</span></span>
<span data-line><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">            dir</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">TMP_DIR</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">delete</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">False</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">suffix</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;.html&quot;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        )</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        ReportGenerator(report_data, test_report_file.name)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">if</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> __name__</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> ==</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;__main__&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    unittest.main()</span></span></code></pre></figure>
<p>In  <code>Makefile</code>, we defined the test step and clean up step of the project.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="makefile" data-theme="github-dark github-light"><code data-language="makefile" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">.PHONY</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: test</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">test</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">	python3 -m unittest tests/test_gen_report.py</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">.PHONY</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: clean</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">clean</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">	rm -rf /tmp/plotly_gen_report</span></span></code></pre></figure>
<h2 id="implement-the-core-function">Implement the Core Function<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#implement-the-core-function" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>To make the post more clear, I will just put some code snipets to demostrate the core structure of the implementation, full version of code can be accessed at github repo:</p>
<p><a href="https://github.com/XiGou/plotly_gen_offline_report" class="external">https://github.com/XiGou/plotly_gen_offline_report<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>In ReportGenerator class, we use 3 functions to plot the figure or table by plotly and pandas library, and got the HTML string, and use <code>gen_report_html_str()</code> to compose them all and filled into <code>_report_html_template</code> and got the final html string. At lase we write it into an HTML file.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-dark github-light"><code data-language="python" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> plotly.offline.offline </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> get_plotlyjs</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> pkgutil</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> pandas </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">as</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> pd</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> plotly.express </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">as</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> px</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ReportData</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    tabular_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> None</span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  # [[&quot;header&quot;], [1]]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    time_series_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []  </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;"># [{&quot;timestamp&quot;:1, &quot;value&quot;: 1}]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    bar_chart_data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []  </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;"># [{&quot;value&quot;:1, &quot;count&quot;: 1}]</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">PKG_NAME</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;plotly_offline_report&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ReportGenerator</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    _report_html_template </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">		# defined the basic html wrapper to display the report</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">		&quot;&quot;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> __init__</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self, report_data, report_filename):</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_data: ReportData </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> report_data</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_filename </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> report_filename</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_sections </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> _gen_report_html_str_for_ts_data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_data.time_series_data</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">				# plot line figure using plotly</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        return</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">            &lt;h3> Time Series Data &lt;/h3></span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            {</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">fig.to_html(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">full_html</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">False</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">include_plotlyjs</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">False</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">        &quot;&quot;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> _gen_report_html_str_for_barchart_data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_data.bar_chart_data</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        data.sort(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">key</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=lambda</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> x: x[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;value&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">])</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">        # plot barchart using plotly</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        return</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">            &lt;h3> Bar Chart Data &lt;/h3></span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            {</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">fig.to_html(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">full_html</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">False</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">include_plotlyjs</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">False</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">        &quot;&quot;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> _gen_report_html_str_for_tabular_data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_data.tabular_data</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">        # compose the pandas dataframe</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        return</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">            &lt;h2> Tabular Data &lt;/h2></span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            {</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">df_stylers.to_html()</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">        &quot;&quot;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> gen_report_html_str</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">				...</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> gen_report_file</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        with</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> open</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_filename, </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;w&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">encoding</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;utf-8&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">as</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> f:</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">            f.write(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.gen_report_html_str())</span></span></code></pre></figure>
<h2 id="make-it-self-contained">Make It Self-contained<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#make-it-self-contained" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>The key point of this project is to make the report self-contained, so it can be opened in enviroment without internet.</p>
<p>In the <code>function call to_html(full_html=False, include_plotlyjs=False)</code> of plotly, we set <code>full_html=False</code> to generate just an html div instead of a complete HTML file include the hearder and body. we set  <code>include_plotlyjs=False</code> because we need to include multple figure in one report HTML, we don‚Äôt want it to appear multiple time in one page, and each plotly js script make our file few MBs bigger.</p>
<p>the implementation of <code>gen_report_html_str()</code> is below, we make the bootstrap and plotly js/css as static assets of our project, we use bootstrap here to build a grid layout and make our page looks better, and we include these contents directly into the <code>_report_html_template</code> then we got a full version of our report.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-dark github-light"><code data-language="python" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> gen_report_html_str</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(self):</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_sections </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._gen_report_html_str_for_tabular_data(),</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._gen_report_html_str_for_barchart_data(),</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">            self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._gen_report_html_str_for_ts_data(),</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        ]</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        plotlyjs_script </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">        {self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._window_plotly_config</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">        &lt;script type=&quot;text/javascript&quot;></span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">get_plotlyjs()</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&lt;/script></span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        bootstrapjs </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;&lt;script></span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">pkgutil.get_data(</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{PKG_NAME}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">.assets&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;bootstrap.bundle.min.js&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">).decode(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;utf-8&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&lt;/script>&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        bootstrapcss </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;&quot;&quot;&lt;style></span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">pkgutil.get_data(</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{PKG_NAME}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">.assets&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;bootstrap.min.css&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">).decode(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;utf-8&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&lt;/style>&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        return</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._report_html_template.format(</span></span>
<span data-line><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">            report_sections</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">self</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._compose_report_sections(),</span></span>
<span data-line><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">            style</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">bootstrapcss,</span></span>
<span data-line><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">            scripts</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">f</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">{</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">plotlyjs_script</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}\n{</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">bootstrapjs</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">}</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        )</span></span></code></pre></figure>
<h2 id="glimpse-of-the-report-page">Glimpse of The Report Page<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#glimpse-of-the-report-page" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>It looks morden, elegant, and it is interative.</p>
<p><img src="../images/rxpfH1h.jpeg" width="auto" height="auto" alt/></p></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#background---requirements-definination" data-for="background---requirements-definination">Background  &amp; Requirements Definination</a></li><li class="depth-1"><a href="#requirements-clearify" data-for="requirements-clearify">Requirements Clearify:</a></li><li class="depth-0"><a href="#implementation" data-for="implementation">Implementation</a></li><li class="depth-1"><a href="#write-the-interface-and-testcase-first" data-for="write-the-interface-and-testcase-first">Write the Interface and Testcase First</a></li><li class="depth-1"><a href="#implement-the-core-function" data-for="implement-the-core-function">Implement the Core Function</a></li><li class="depth-1"><a href="#make-it-self-contained" data-for="make-it-self-contained">Make It Self-contained</a></li><li class="depth-1"><a href="#glimpse-of-the-report-page" data-for="glimpse-of-the-report-page">Glimpse of The Report Page</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.1.6</a>, ¬© 2024</p><ul><li><a href="https://github.com/XiGou">GitHub</a></li><li><a href="https://linkedin.com/in/xigou">Linkedin</a></li><li><a href="https://stackoverflow.com/users/10871150/xi-gou">StackOverflow</a></li><li><a href="mailto:gouxivae@gmail.com">Email</a></li></ul></footer></div></body><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function o(){let e=this.parentElement;e.classList.toggle("is-collapsed");let l=e.classList.contains("is-collapsed")?this.scrollHeight:e.scrollHeight;e.style.maxHeight=l+"px";let c=e,t=e.parentElement;for(;t;){if(!t.classList.contains("callout"))return;let n=t.classList.contains("is-collapsed")?t.scrollHeight:t.scrollHeight+c.scrollHeight;t.style.maxHeight=n+"px",c=t,t=t.parentElement}}function i(){let e=document.getElementsByClassName("callout is-collapsible");for(let s of e){let l=s.firstElementChild;if(l){l.removeEventListener("click",o),l.addEventListener("click",o);let t=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=t+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
          const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
          mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: darkMode ? 'dark' : 'default'
          });
          document.addEventListener('nav', async () => {
            await mermaid.run({
              querySelector: '.mermaid'
            })
          });
          </script><script src="https://www.googletagmanager.com/gtag/js?id=G-4FDRZXCQ8S" type="application/javascript"></script><script src="../postscript.js" type="module"></script></html>