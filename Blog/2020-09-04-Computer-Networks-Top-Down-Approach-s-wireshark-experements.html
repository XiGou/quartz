<!DOCTYPE html>
<html><head><title>Wireshark experements of Computer Networks: Top-Down Approach</title><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Wireshark experements of Computer Networks: Top-Down Approach"/><meta property="og:description" content="intruduction “Tell me and I forget. Show me and I remember. Involve me and I understand.” Chinese proverb I read the Computer Networks: Top-Down Approach about 3 years ago preparing for my CN-GRE, after read this book, I learned a lot about computer network, the reading helped me to fill in the blanks on the test paper, but I don’t have the confidence to tell others I know the principles behind computer network, expecially after years of forgetting process."/><meta property="og:image" content="https://quartz.19960312.xyz/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="intruduction “Tell me and I forget. Show me and I remember. Involve me and I understand.” Chinese proverb I read the Computer Networks: Top-Down Approach about 3 years ago preparing for my CN-GRE, after read this book, I learned a lot about computer network, the reading helped me to fill in the blanks on the test paper, but I don’t have the confidence to tell others I know the principles behind computer network, expecially after years of forgetting process."/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=Roboto Mono&amp;family=Noto Serif SC:wght@400;700&amp;family=Noto Serif SC:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Blog/2020-09-04-Computer-Networks-Top-Down-Approach-s-wireshark-experements"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="..">😄 Joker's Digital Garden</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Light mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Dark mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="recent-notes desktop-only"><h3>Recent</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Travels/Travels" class="internal">1970~2023</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Readings/Videos/Videos" class="internal">Videos</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Readings/Papers/Papers" class="internal">Papers</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Knowledges/UsefulSnipets/Nvme-Device-Operation-cmds" class="internal">Nvme Device Operation cmds</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Knowledges/How-to-check-the-binding-glibc-version-of-a-binary" class="internal">How to check the binding glibc version of a binary</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li></ul><p><a href="../tags">See 112 more →</a></p></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../Blog/">Blog</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Wireshark experements of Computer Networks: Top-Down Approach</a></div></nav><h1 class="article-title">Wireshark experements of Computer Networks: Top-Down Approach</h1><p class="content-meta">Sep 04, 2020, 40 min read</p><ul class="tags"><li><a href="../tags/Computer-Network" class="internal tag-link">#Computer-Network</a></li></ul><div class="recent-notes mobile-only"><h3>Recent</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Travels/Travels" class="internal">1970~2023</a></h3></div><p class="meta">Mar 17, 2024</p><ul class="tags"></ul></div></li></ul><p><a href="../tags">See 116 more →</a></p></div></div></div><article class="popover-hint"><h1 id="intruduction">intruduction<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#intruduction" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<blockquote>
<p>“Tell me and I forget. Show me and I remember. Involve me and I understand.”<br/>
<em>Chinese proverb</em></p>
</blockquote>
<p>I read the <em>Computer Networks: Top-Down Approach</em> about 3 years ago preparing for my CN-GRE, after read this book, I learned a lot about computer network, the reading helped me to fill in the blanks on the test paper, but I don’t have the confidence to tell others I know the principles behind computer network, expecially after years of forgetting process.</p>
<p>So I decide to do a wireshark homework in this weekend.</p>


<h1 id="experiments">Experiments<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiments" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="basic-skill-capturing-packets-using-wireshark">Basic skill: capturing packets using Wireshark<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#basic-skill-capturing-packets-using-wireshark" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><em>Wiresharks</em> is a powerful tools to capture, mastering it needs much time, but I think knowing three steps below is enough to start these labs:</p>
<ol>
<li>select an interface, and click the “shark fin” icon to start capturing packets;</li>
<li>do something can trigger the protocal you want to observe;</li>
<li>click stop icon to stop capturing and start research.</li>
</ol>
<p>Need to know more, just go to reference<a href="#refer-anchor-1" class="internal"><sup>1</sup></a>.</p>
<h2 id="http">HTTP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#http" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="the-basic-http-getresponse-interaction">The Basic HTTP GET/response interaction<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#the-basic-http-getresponse-interaction" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>What I did:
Open Microsoft Edge browser and open this url:  <a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html" class="external">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
<p>Captured packets:</p>
































<div class="table-container"><table><thead><tr><th>“No.”</th><th>“Time”</th><th>“Source”</th><th>“Destination”</th><th>“Protocol”</th><th>“Length”</th><th>“Info”</th></tr></thead><tbody><tr><td>“370872”</td><td>“899.553481”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“581”</td><td>“GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1 ”</td></tr><tr><td>“372140”</td><td>“899.824395”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“540”</td><td>“HTTP/1.1 200 OK  (text/html)”</td></tr></tbody></table></div>
<p>Detail of packets:
Request:</p>
<pre><code>Frame 370872: 581 bytes on wire (4648 bits), 581 bytes captured (4648 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 17536, Dst Port: 80, Seq: 1, Ack: 1, Len: 527
Hypertext Transfer Protocol
    GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1\r\n
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Cache-Control: max-age=0\r\n
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]
    [HTTP request 1/1]
    [Response in frame: 372140]

</code></pre>
<p>Response:</p>
<pre><code>Frame 372140: 540 bytes on wire (4320 bits), 540 bytes captured (4320 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3
Transmission Control Protocol, Src Port: 80, Dst Port: 17536, Seq: 1, Ack: 528, Len: 486
Hypertext Transfer Protocol
    HTTP/1.1 200 OK\r\n
    Date: Sun, 05 Sep 2021 09:03:10 GMT\r\n
    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n
    ETag: &quot;80-5cb393aaf07a9&quot;\r\n
    Accept-Ranges: bytes\r\n
    Content-Length: 128\r\n
    Keep-Alive: timeout=5, max=100\r\n
    Connection: Keep-Alive\r\n
    Content-Type: text/html; charset=UTF-8\r\n
    \r\n
    [HTTP response 1/1]
    [Time since request: 0.270914000 seconds]
    [Request in frame: 370872]
    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]
    File Data: 128 bytes
Line-based text data: text/html (4 lines)
    &lt;html>\n
    Congratulations.  You've downloaded the file \n
    http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html!\n
    &lt;/html>\n

</code></pre>
<p>Q&amp;As:</p>
<ol>
<li>
<p>Is your browser running HTTP version 1.0, 1.1, or 2?  What version of HTTP is the server running?
From the header of request packet, I can see the HTTP version of my browser and server are both HTTP/1.1.</p>
</li>
<li>
<p>What languages (if any) does your browser indicate that it can accept to the server?
It is in the “Accept-Language” of the request packet.</p>
</li>
<li>
<p>What is the IP address of your computer?  What is the IP address of the gaia.cs.umass.edu server?
The Internet Protocal layer indicates my IP(Src) is 192.168.1.3, IP of gaia.cs.umass.edu server(Dst) is 128.119.245.12.</p>
</li>
<li>
<p>What is the status code returned from the server to your browser?
200 OK.</p>
</li>
<li>
<p>When was the HTML file that you are retrieving last modified at the server?
Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n</p>
</li>
<li>
<p>How many bytes of content are being returned to your browser?
540 bytes.</p>
</li>
<li>
<p>By inspecting the raw data in the packet content window, do you see any headers within the data that are not displayed in the packet-listing window?  If so, name one.
Content-Length.</p>
</li>
</ol>
<h3 id="the-http-conditional-getresponse-interaction">The HTTP CONDITIONAL GET/response interaction<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#the-http-conditional-getresponse-interaction" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Enter the following URL into your browser
<a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html" class="external">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
Your browser should display a very simple five-line HTML file.</li>
<li>Quickly enter the same URL into your browser again (or simply select the refresh button on your browser)</li>
</ul>
<p>Captured packets:</p>


















































<div class="table-container"><table><thead><tr><th>“No.”</th><th>“Time”</th><th>“Source”</th><th>“Destination”</th><th>“Protocol”</th><th>“Length”</th><th>“Info”</th></tr></thead><tbody><tr><td>“142”</td><td>“6.368786”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“555”</td><td>“GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1 ”</td></tr><tr><td>“183”</td><td>“6.633550”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“784”</td><td>“HTTP/1.1 200 OK  (text/html)”</td></tr><tr><td>“237”</td><td>“8.389410”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“667”</td><td>“GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1 ”</td></tr><tr><td>“268”</td><td>“8.655003”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“293”</td><td>“HTTP/1.1 304 Not Modified ”</td></tr></tbody></table></div>
<p>Detail of packets:</p>
<pre><code>Frame 142: 555 bytes on wire (4440 bits), 555 bytes captured (4440 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 1053, Dst Port: 80, Seq: 1, Ack: 1, Len: 501
Hypertext Transfer Protocol
    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
    [HTTP request 1/2]
    [Response in frame: 183]
    [Next request in frame: 237]
</code></pre>
<pre><code>Frame 183: 784 bytes on wire (6272 bits), 784 bytes captured (6272 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3
Transmission Control Protocol, Src Port: 80, Dst Port: 1053, Seq: 1, Ack: 502, Len: 730
Hypertext Transfer Protocol
    HTTP/1.1 200 OK\r\n
    Date: Sun, 05 Sep 2021 12:49:23 GMT\r\n
    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n
    ETag: &quot;173-5cb393aaefbf1&quot;\r\n
    Accept-Ranges: bytes\r\n
    Content-Length: 371\r\n
    Keep-Alive: timeout=5, max=100\r\n
    Connection: Keep-Alive\r\n
    Content-Type: text/html; charset=UTF-8\r\n
    \r\n
    [HTTP response 1/2]
    [Time since request: 0.264764000 seconds]
    [Request in frame: 142]
    [Next request in frame: 237]
    [Next response in frame: 268]
    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
    File Data: 371 bytes
Line-based text data: text/html (10 lines)
    \n
    &lt;html>\n
    \n
    Congratulations again!  Now you've downloaded the file lab2-2.html. &lt;br>\n
    This file's last modification date will not change.  &lt;p>\n
    Thus  if you download this multiple times on your browser, a complete copy &lt;br>\n
    will only be sent once by the server due to the inclusion of the IN-MODIFIED-SINCE&lt;br>\n
    field in your browser's HTTP GET request to the server.\n
    \n
    &lt;/html>\n


</code></pre>
<pre><code>Frame 237: 667 bytes on wire (5336 bits), 667 bytes captured (5336 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 1053, Dst Port: 80, Seq: 502, Ack: 731, Len: 613
Hypertext Transfer Protocol
    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Cache-Control: max-age=0\r\n
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    If-None-Match: &quot;173-5cb393aaefbf1&quot;\r\n
    If-Modified-Since: Sun, 05 Sep 2021 05:59:01 GMT\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
    [HTTP request 2/2]
    [Prev request in frame: 142]
    [Response in frame: 268]

</code></pre>
<pre><code>Frame 268: 293 bytes on wire (2344 bits), 293 bytes captured (2344 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3
Transmission Control Protocol, Src Port: 80, Dst Port: 1053, Seq: 731, Ack: 1115, Len: 239
Hypertext Transfer Protocol
    HTTP/1.1 304 Not Modified\r\n
    Date: Sun, 05 Sep 2021 12:49:25 GMT\r\n
    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
    Connection: Keep-Alive\r\n
    Keep-Alive: timeout=5, max=99\r\n
    ETag: &quot;173-5cb393aaefbf1&quot;\r\n
    \r\n
    [HTTP response 2/2]
    [Time since request: 0.265593000 seconds]
    [Prev request in frame: 142]
    [Prev response in frame: 183]
    [Request in frame: 237]
    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
</code></pre>
<p>Q&amp;As:
8.	Inspect the contents of the first HTTP GET request from your browser to the server.  Do you see an “IF-MODIFIED-SINCE” line in the HTTP GET?
No.</p>
<ol start="9">
<li>
<p>Inspect the contents of the server response. Did the server explicitly return the contents of the file?   How can you tell?
Yes, in the File Data field of the response packet.</p>
</li>
<li>
<p>Now inspect the contents of the second HTTP GET request from your browser to the server.  Do you see an “IF-MODIFIED-SINCE:” line in the HTTP GET ? If so, what information follows the “IF-MODIFIED-SINCE:” header?
Yes,  “If-Modified-Since: Sun, 05 Sep 2021 05:59:01 GMT\r\n”.</p>
</li>
<li>
<p>What is the HTTP status code and phrase returned from the server in response to this second HTTP GET?  Did the server explicitly return the contents of the file?   Explain.
Status code is 304(Not Modified), server didn’t return the contents of the file explicitly,  because the browser keep a copy of this file last modified at  “Sun, 05 Sep 2021 05:59:01 GMT”, and put this timestamp in “IF-MODIFIED-SINCE:” header field to inform the server no need to return the file didn’t modified after the timestamp.</p>
</li>
</ol>
<h3 id="retrieving-long-documents">Retrieving Long Documents<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#retrieving-long-documents" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Enter the following URL into your browser
<a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html" class="external">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
Your browser should display the rather lengthy US Bill of Rights.</li>
</ul>
<p>Packets Captured:</p>
































<div class="table-container"><table><thead><tr><th>“No.”</th><th>“Time”</th><th>“Source”</th><th>“Destination”</th><th>“Protocol”</th><th>“Length”</th><th>“Info”</th></tr></thead><tbody><tr><td>“146”</td><td>“4.150099”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“555”</td><td>“GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1 ”</td></tr><tr><td>“176”</td><td>“4.411527”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“679”</td><td>“HTTP/1.1 200 OK  (text/html)”</td></tr></tbody></table></div>
<p>Packets Details:</p>
<pre><code>Frame 146: 555 bytes on wire (4440 bits), 555 bytes captured (4440 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 1028, Dst Port: 80, Seq: 1, Ack: 1, Len: 501
Hypertext Transfer Protocol
    GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1\r\n
        [Expert Info (Chat/Sequence): GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1\r\n]
        Request Method: GET
        Request URI: /wireshark-labs/HTTP-wireshark-file3.html
        Request Version: HTTP/1.1
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]
    [HTTP request 1/1]
    [Response in frame: 176]

</code></pre>
<pre><code>Frame 176: 679 bytes on wire (5432 bits), 679 bytes captured (5432 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
    Destination: Micro-St_06:62:ec (00:d8:61:06:62:ec)
    Source: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
    Type: IPv4 (0x0800)
Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3
Transmission Control Protocol, Src Port: 80, Dst Port: 1028, Seq: 4237, Ack: 502, Len: 625
[4 Reassembled TCP Segments (4861 bytes): #172(1412), #173(1412), #175(1412), #176(625)]
    [Frame: 172, payload: 0-1411 (1412 bytes)]
    [Frame: 173, payload: 1412-2823 (1412 bytes)]
    [Frame: 175, payload: 2824-4235 (1412 bytes)]
    [Frame: 176, payload: 4236-4860 (625 bytes)]
    [Segment count: 4]
    [Reassembled TCP length: 4861]
    [Reassembled TCP Data: 485454502f312e3120323030204f4b0d0a446174653a2053756e2c203035205365702032…]
Hypertext Transfer Protocol
    HTTP/1.1 200 OK\r\n
        [Expert Info (Chat/Sequence): HTTP/1.1 200 OK\r\n]
        Response Version: HTTP/1.1
        Status Code: 200
        [Status Code Description: OK]
        Response Phrase: OK
    Date: Sun, 05 Sep 2021 13:12:00 GMT\r\n
    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n
    ETag: &quot;1194-5cb393aaeb1b8&quot;\r\n
    Accept-Ranges: bytes\r\n
    Content-Length: 4500\r\n
    Keep-Alive: timeout=5, max=100\r\n
    Connection: Keep-Alive\r\n
    Content-Type: text/html; charset=UTF-8\r\n
    \r\n
    [HTTP response 1/1]
    [Time since request: 0.261428000 seconds]
    [Request in frame: 146]
    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]
    File Data: 4500 bytes
Line-based text data: text/html (98 lines)

</code></pre>
<p>Q&amp;As:</p>
<ol start="12">
<li>
<p>How many HTTP GET request messages did your browser send?  Which packet number in the trace contains the GET message for the Bill or Rights?
Only one, packet 146.</p>
</li>
<li>
<p>Which packet number in the trace contains the status code and phrase associated with the response to the HTTP GET request?
Packet 176.</p>
</li>
<li>
<p>What is the status code and phrase in the response?
200(OK).</p>
</li>
<li>
<p>How many data-containing TCP segments were needed to carry the single HTTP response and the text of the Bill of Rights?</p>
</li>
<li></li>
</ol>
<h3 id="html-documents-with-embedded-objects">HTML Documents with Embedded Objects<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#html-documents-with-embedded-objects" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Enter the following URL into your browser
<a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html" class="external">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
Your browser should display a short HTML file with two images. These two images are referenced in the base HTML file.  That is, the images themselves are not contained in the HTML; instead the URLs for the images are contained in the downloaded HTML file. As discussed in the textbook, your browser will have to retrieve these logos from the indicated web sites.   Our publisher’s logo is retrieved from the gaia.cs.umass.edu web site.   The image of our 8th edition cover (one of our favorite covers) is stored at a server in France.</li>
</ul>
<p>Packets Captured:</p>




































































<div class="table-container"><table><thead><tr><th>“No.”</th><th>“Time”</th><th>“Source”</th><th>“Destination”</th><th>“Protocol”</th><th>“Length”</th><th>“Info”</th></tr></thead><tbody><tr><td>“28”</td><td>“2.033457”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“581”</td><td>“GET /wireshark-labs/HTTP-wireshark-file4.html HTTP/1.1 ”</td></tr><tr><td>“41”</td><td>“2.304704”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“1355”</td><td>“HTTP/1.1 200 OK  (text/html)”</td></tr><tr><td>“42”</td><td>“2.338977”</td><td>“192.168.1.3”</td><td>“128.119.245.12”</td><td>“HTTP”</td><td>“501”</td><td>“GET /pearson.png HTTP/1.1 ”</td></tr><tr><td>“47”</td><td>“2.530706”</td><td>“192.168.1.3”</td><td>“178.79.137.164”</td><td>“HTTP”</td><td>“468”</td><td>“GET /8E_cover_small.jpg HTTP/1.1 ”</td></tr><tr><td>“55”</td><td>“2.609925”</td><td>“128.119.245.12”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“841”</td><td>“HTTP/1.1 200 OK  (PNG)”</td></tr><tr><td>“58”</td><td>“2.695694”</td><td>“178.79.137.164”</td><td>“192.168.1.3”</td><td>“HTTP”</td><td>“225”</td><td>“HTTP/1.1 301 Moved Permanently ”</td></tr></tbody></table></div>
<p>Packets Details:
…</p>
<p>Q&amp;As:
16.	How many HTTP GET request messages did your browser send?  To which Internet addresses were these GET requests sent?
Totally 3 GET requests, 2 to 128.119.245.12 to get html file and pearson.png, 1 to 178.79.137.164 for the 8E_cover_small.jpg.</p>
<ol start="17">
<li>Can you tell whether your browser downloaded the two images serially, or whether they were downloaded from the two web sites in parallel?  Explain.
In parallel.</li>
</ol>
<pre><code class="mermaid">sequenceDiagram
    participant Browser
    participant Server
    Browser ->> Server: GET /pearson.png time:2.338977
    Browser -->> Server: GET /8E_cover_small.jpg time:2.530706
    Server ->> Browser: pearson.png time:2.609925
    Server -->>Browser: 8E_cover_small.jpg time:2.695694
</code></pre>
<h3 id="http-authentication">HTTP Authentication<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#http-authentication" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Enter the following URL into your browser
<a href="http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html" class="external">http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
Type the requested user name and password into the pop up box.  The username is “wireshark-students” (without the quotes), and the password is “network” (again, without the quotes).</li>
</ul>
<p>Packets Captured:</p>


















































<div class="table-container"><table><thead><tr><th>No.</th><th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Length</th><th>Info</th></tr></thead><tbody><tr><td>125</td><td>5.558621</td><td>192.168.1.3</td><td>128.119.245.12</td><td>HTTP</td><td>597</td><td>GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1</td></tr><tr><td>140</td><td>5.823233</td><td>128.119.245.12</td><td>192.168.1.3</td><td>HTTP</td><td>771</td><td>HTTP/1.1 401 Unauthorized  (text/html)</td></tr><tr><td>726</td><td>26.553076</td><td>192.168.1.3</td><td>128.119.245.12</td><td>HTTP</td><td>656</td><td>GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1</td></tr><tr><td>737</td><td>26.823450</td><td>128.119.245.12</td><td>192.168.1.3</td><td>HTTP</td><td>544</td><td>HTTP/1.1 200 OK  (text/html)</td></tr></tbody></table></div>
<p>Packets Details:</p>
<pre><code>Frame 125: 597 bytes on wire (4776 bits), 597 bytes captured (4776 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 28007, Dst Port: 80, Seq: 1, Ack: 1, Len: 543
Hypertext Transfer Protocol
    GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n
        [Expert Info (Chat/Sequence): GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n]
        Request Method: GET
        Request URI: /wireshark-labs/protected_pages/HTTP-wireshark-file5.html
        Request Version: HTTP/1.1
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Cache-Control: max-age=0\r\n
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html]
    [HTTP request 1/1]
    [Response in frame: 140]

</code></pre>
<pre><code>Frame 726: 656 bytes on wire (5248 bits), 656 bytes captured (5248 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 1028, Dst Port: 80, Seq: 1, Ack: 1, Len: 602
Hypertext Transfer Protocol
    GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n
        [Expert Info (Chat/Sequence): GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n]
        Request Method: GET
        Request URI: /wireshark-labs/protected_pages/HTTP-wireshark-file5.html
        Request Version: HTTP/1.1
    Host: gaia.cs.umass.edu\r\n
    Connection: keep-alive\r\n
    Cache-Control: max-age=0\r\n
    Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=\r\n
        Credentials: wireshark-students:network
    Upgrade-Insecure-Requests: 1\r\n
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
    Accept-Encoding: gzip, deflate\r\n
    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n
    \r\n
    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html]
    [HTTP request 1/1]
    [Response in frame: 737]

</code></pre>
<p>Q&amp;As:</p>
<ol start="18">
<li>What is the server’s response (status code and phrase) in response to the initial HTTP GET message from your browser?</li>
</ol>
<p>401 Unauthorized.</p>
<ol start="19">
<li>When your browser’s sends the HTTP GET message for the second time, what new field is included in the HTTP GET message?
Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=\r\n</li>
</ol>
<h2 id="dns">DNS<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dns" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="trace-dns-from-web-browser">Trace DNS from web browser<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#trace-dns-from-web-browser" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Open the following URL into your browser
<a href="http://gaia.cs.umass.edu/kurose_ross/index.php" class="external">http://gaia.cs.umass.edu/kurose_ross/index.php<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p>Captured packets:</p>
































<div class="table-container"><table><thead><tr><th>No.</th><th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Length</th><th>Info</th></tr></thead><tbody><tr><td>20</td><td>4.898665</td><td>fe80::604d:b1a2:55ef:5877</td><td>fe80::1</td><td>DNS</td><td>97</td><td>Standard query 0xcba9 A gaia.cs.umass.edu</td></tr><tr><td>29</td><td>4.908337</td><td>fe80::1</td><td>fe80::604d:b1a2:55ef:5877</td><td>DNS</td><td>113</td><td>Standard query response 0xcba9 A gaia.cs.umass.edu A 128.119.245.12</td></tr></tbody></table></div>
<p>Detail of packets:</p>
<pre><code>Frame 20: 97 bytes on wire (776 bits), 97 bytes captured (776 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1
User Datagram Protocol, Src Port: 61277, Dst Port: 53
Domain Name System (query)
    Transaction ID: 0xcba9
    Flags: 0x0100 Standard query
    Questions: 1
    Answer RRs: 0
    Authority RRs: 0
    Additional RRs: 0
    Queries
        gaia.cs.umass.edu: type A, class IN
            Name: gaia.cs.umass.edu
            [Name Length: 17]
            [Label Count: 4]
            Type: A (Host Address) (1)
            Class: IN (0x0001)
    [Response In: 29]

</code></pre>
<pre><code>Frame 29: 113 bytes on wire (904 bits), 113 bytes captured (904 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877
User Datagram Protocol, Src Port: 53, Dst Port: 61277
Domain Name System (response)
    Transaction ID: 0xcba9
    Flags: 0x8180 Standard query response, No error
    Questions: 1
    Answer RRs: 1
    Authority RRs: 0
    Additional RRs: 0
    Queries
        gaia.cs.umass.edu: type A, class IN
            Name: gaia.cs.umass.edu
            [Name Length: 17]
            [Label Count: 4]
            Type: A (Host Address) (1)
            Class: IN (0x0001)
    Answers
        gaia.cs.umass.edu: type A, class IN, addr 128.119.245.12
    [Request In: 20]
    [Time: 0.009672000 seconds]


</code></pre>
<p>Q&amp;As:</p>
<ol>
<li>Locate the first DNS query message resolving the name gaia.cs.umass.edu. What is the packet number  in the trace for the DNS query message?  Is this query message sent over UDP or TCP?</li>
</ol>
<p>20, UDP.</p>
<ol start="2">
<li>Now locate the corresponding DNS response to the initial DNS query. What is the packet number in the trace for the DNS response message?  Is this response message received via UDP or TCP?</li>
</ol>
<p>29, UDP.</p>
<ol start="3">
<li>What is the destination port for the DNS query message? What is the source port of the DNS response message?</li>
</ol>
<p>53 .</p>
<ol start="4">
<li>To what IP address is the DNS query message sent?</li>
</ol>
<p>fe80::1.</p>
<ol start="5">
<li>Examine the DNS query message. How many “questions” does this DNS message contain? How many “answers” answers does it contain?</li>
</ol>
<p>Questions: 1
Answer RRs: 0</p>
<ol start="6">
<li>Examine the DNS response message to the initial query message. How many “questions” does this DNS message contain? How many “answers” answers does it contain?</li>
</ol>
<p>Questions: 1
Answer RRs: 1</p>
<h3 id="trace-dns-from-nslookup">Trace DNS from nslookup<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#trace-dns-from-nslookup" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Do an nslookup on <a href="http://www.cs.umass.edu" class="external">www.cs.umass.edu<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p>Captured packets:</p>


















































<div class="table-container"><table><thead><tr><th>No.</th><th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Length</th><th>Info</th></tr></thead><tbody><tr><td>56</td><td>10.981691</td><td>fe80::604d:b1a2:55ef:5877</td><td>fe80::1</td><td>DNS</td><td>96</td><td>Standard query 0x7a54 A <a href="http://www.cs.umass.edu" class="external">www.cs.umass.edu<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></td></tr><tr><td>57</td><td>10.981916</td><td>fe80::604d:b1a2:55ef:5877</td><td>fe80::1</td><td>DNS</td><td>96</td><td>Standard query 0xd102 AAAA <a href="http://www.cs.umass.edu" class="external">www.cs.umass.edu<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></td></tr><tr><td>58</td><td>11.232144</td><td>fe80::1</td><td>fe80::604d:b1a2:55ef:5877</td><td>DNS</td><td>96</td><td>Standard query response 0xd102 AAAA <a href="http://www.cs.umass.edu" class="external">www.cs.umass.edu<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></td></tr><tr><td>59</td><td>11.255062</td><td>fe80::1</td><td>fe80::604d:b1a2:55ef:5877</td><td>DNS</td><td>112</td><td>Standard query response 0x7a54 A <a href="http://www.cs.umass.edu" class="external">www.cs.umass.edu<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> A 128.119.240.84</td></tr></tbody></table></div>
<p>Detail of packets:</p>
<pre><code>Frame 56: 96 bytes on wire (768 bits), 96 bytes captured (768 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1
User Datagram Protocol, Src Port: 51185, Dst Port: 53
Domain Name System (query)
    Transaction ID: 0x7a54
    Flags: 0x0100 Standard query
    Questions: 1
    Answer RRs: 0
    Authority RRs: 0
    Additional RRs: 0
    Queries
        www.cs.umass.edu: type A, class IN
            Name: www.cs.umass.edu
            [Name Length: 16]
            [Label Count: 4]
            Type: A (Host Address) (1)
            Class: IN (0x0001)
    [Response In: 59]

</code></pre>
<pre><code>Frame 59: 112 bytes on wire (896 bits), 112 bytes captured (896 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877
User Datagram Protocol, Src Port: 53, Dst Port: 51185
Domain Name System (response)
    Transaction ID: 0x7a54
    Flags: 0x8180 Standard query response, No error
    Questions: 1
    Answer RRs: 1
    Authority RRs: 0
    Additional RRs: 0
    Queries
        www.cs.umass.edu: type A, class IN
            Name: www.cs.umass.edu
            [Name Length: 16]
            [Label Count: 4]
            Type: A (Host Address) (1)
            Class: IN (0x0001)
    Answers
        www.cs.umass.edu: type A, class IN, addr 128.119.240.84
    [Request In: 56]
    [Time: 0.273371000 seconds]

</code></pre>
<p>Q&amp;As:</p>
<ol start="7">
<li>What is the destination port for the DNS query message? What is the source port of the DNS response message?</li>
</ol>
<p>53</p>
<ol start="8">
<li>To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?</li>
</ol>
<p>fe80::1, yes.</p>
<ol start="9">
<li>Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?</li>
</ol>
<p>No.</p>
<ol start="10">
<li>Examine the DNS response message to the query message. How many “questions” does this DNS response message contain? How many “answers”?</li>
</ol>
<p>Questions: 1
Answer RRs: 1</p>
<h3 id="trace-dns-from-nslookup-with-ns-type-record">Trace DNS from nslookup with NS type record<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#trace-dns-from-nslookup-with-ns-type-record" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Do an nslookup -type=NS umass.edu</li>
</ul>
<p>Captured packets:</p>
































<div class="table-container"><table><thead><tr><th>No.</th><th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Length</th><th>Info</th></tr></thead><tbody><tr><td>37</td><td>1.731935</td><td>fe80::604d:b1a2:55ef:5877</td><td>fe80::1</td><td>DNS</td><td>89</td><td>Standard query 0x0002 NS umass.edu</td></tr><tr><td>38</td><td>1.738860</td><td>fe80::1</td><td>fe80::604d:b1a2:55ef:5877</td><td>DNS</td><td>143</td><td>Standard query response 0x0002 NS umass.edu NS ns2.umass.edu NS ns1.umass.edu NS ns3.umass.edu</td></tr></tbody></table></div>
<p>Detail of packets:</p>
<pre><code>Frame 37: 89 bytes on wire (712 bits), 89 bytes captured (712 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)
Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1
User Datagram Protocol, Src Port: 56756, Dst Port: 53
Domain Name System (query)
    Transaction ID: 0x0002
    Flags: 0x0100 Standard query
    Questions: 1
    Answer RRs: 0
    Authority RRs: 0
    Additional RRs: 0
    Queries
        umass.edu: type NS, class IN
            Name: umass.edu
            [Name Length: 9]
            [Label Count: 2]
            Type: NS (authoritative Name Server) (2)
            Class: IN (0x0001)
    [Response In: 38]

</code></pre>
<pre><code>Frame 38: 143 bytes on wire (1144 bits), 143 bytes captured (1144 bits) on interface \Device\NPF_{0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4}, id 0
Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)
Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877
User Datagram Protocol, Src Port: 53, Dst Port: 56756
Domain Name System (response)
    Transaction ID: 0x0002
    Flags: 0x8180 Standard query response, No error
    Questions: 1
    Answer RRs: 3
    Authority RRs: 0
    Additional RRs: 0
    Queries
        umass.edu: type NS, class IN
            Name: umass.edu
            [Name Length: 9]
            [Label Count: 2]
            Type: NS (authoritative Name Server) (2)
            Class: IN (0x0001)
    Answers
        umass.edu: type NS, class IN, ns ns2.umass.edu
        umass.edu: type NS, class IN, ns ns1.umass.edu
        umass.edu: type NS, class IN, ns ns3.umass.edu
    [Request In: 37]
    [Time: 0.006925000 seconds]

</code></pre>
<p>Q&amp;As:</p>
<ol start="11">
<li>To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?</li>
</ol>
<p>fe80::1, yes.</p>
<ol start="12">
<li>Examine the DNS query message. How many questions does the query have? Does the query message contain any “answers”?</li>
</ol>
<p>No.</p>
<ol start="13">
<li>Examine the DNS response message.  How many answers does the response have?  What information is contained in the answers?</li>
</ol>
<p>3 answers, name servers of the name in query.</p>
<h2 id="tcp">TCP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tcp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="upload-a-150-kb-file">Upload a 150+ KB file<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#upload-a-150-kb-file" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Captured data:</p>
<p>Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet file tcp-wireshark-trace1-1 in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" class="external">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>


































































































































































































<div class="table-container"><table><thead><tr><th>No.</th><th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Length</th><th>Info</th></tr></thead><tbody><tr><td>1</td><td>0.000000</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>78</td><td>55639  >  80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=64 TSval=725607509 TSecr=0 SACK_PERM=1</td></tr><tr><td>2</td><td>0.022414</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>74</td><td>80  >  55639 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1460 SACK_PERM=1 TSval=3913851370 TSecr=725607509 WS=128</td></tr><tr><td>3</td><td>0.022505</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>66</td><td>55639  >  80 [ACK] Seq=1 Ack=1 Win=131712 Len=0 TSval=725607531 TSecr=3913851370</td></tr><tr><td>4</td><td>0.024047</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=1 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td></tr><tr><td>5</td><td>0.024048</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=1449 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td></tr><tr><td>6</td><td>0.024049</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=2897 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td></tr><tr><td>7</td><td>0.052671</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=1449 Win=31872 Len=0 TSval=3913851399 TSecr=725607532</td></tr><tr><td>8</td><td>0.052676</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=2897 Win=34816 Len=0 TSval=3913851400 TSecr=725607532</td></tr><tr><td>9</td><td>0.052774</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=4345 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851399 [TCP segment of a reassembled PDU]</td></tr><tr><td>10</td><td>0.052775</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=5793 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851399 [TCP segment of a reassembled PDU]</td></tr><tr><td>11</td><td>0.052854</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=7241 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td></tr><tr><td>12</td><td>0.052855</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=8689 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td></tr><tr><td>13</td><td>0.053626</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=4345 Win=37760 Len=0 TSval=3913851400 TSecr=725607532</td></tr><tr><td>14</td><td>0.053710</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=10137 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td></tr><tr><td>15</td><td>0.053711</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=11585 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td></tr><tr><td>16</td><td>0.080768</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=5793 Win=40576 Len=0 TSval=3913851421 TSecr=725607560</td></tr><tr><td>17</td><td>0.080771</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=7241 Win=43520 Len=0 TSval=3913851422 TSecr=725607560</td></tr><tr><td>18</td><td>0.080772</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=8689 Win=46336 Len=0 TSval=3913851422 TSecr=725607560</td></tr><tr><td>19</td><td>0.080772</td><td>128.119.245.12</td><td>192.168.86.68</td><td>TCP</td><td>66</td><td>80  >  55639 [ACK] Seq=1 Ack=10137 Win=49280 Len=0 TSval=3913851422 TSecr=725607560</td></tr><tr><td>20</td><td>0.080845</td><td>192.168.86.68</td><td>128.119.245.12</td><td>TCP</td><td>1514</td><td>55639  >  80 [ACK] Seq=13033 Ack=1 Win=131712 Len=1448 TSval=725607588 TSecr=3913851421 [TCP segment of a reassembled PDU]</td></tr></tbody></table></div>
<pre><code>Frame 1: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en0, id 0
Ethernet II, Src: Apple_98:d9:27 (78:4f:43:98:d9:27), Dst: Google_89:0e:c8 (3c:28:6d:89:0e:c8)
Internet Protocol Version 4, Src: 192.168.86.68, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 0, Len: 0
    Source Port: 55639
    Destination Port: 80
    [Stream index: 0]
    [TCP Segment Len: 0]
    Sequence Number: 0    (relative sequence number)
    Sequence Number (raw): 4236649187
    [Next Sequence Number: 1    (relative sequence number)]
    Acknowledgment Number: 0
    Acknowledgment number (raw): 0
    1011 .... = Header Length: 44 bytes (11)
    Flags: 0x002 (SYN)
    Window: 65535
    [Calculated window size: 65535]
    Checksum: 0xa1e4 [unverified]
    [Checksum Status: Unverified]
    Urgent Pointer: 0
    Options: (24 bytes), Maximum segment size, No-Operation (NOP), Window scale, No-Operation (NOP), No-Operation (NOP), Timestamps, SACK permitted, End of Option List (EOL)
        TCP Option - Maximum segment size: 1460 bytes
        TCP Option - No-Operation (NOP)
        TCP Option - Window scale: 6 (multiply by 64)
        TCP Option - No-Operation (NOP)
        TCP Option - No-Operation (NOP)
        TCP Option - Timestamps: TSval 725607509, TSecr 0
        TCP Option - SACK permitted
        TCP Option - End of Option List (EOL)
    [Timestamps]

</code></pre>
<pre><code>Frame 2: 74 bytes on wire (592 bits), 74 bytes captured (592 bits) on interface en0, id 0
Ethernet II, Src: Google_89:0e:c8 (3c:28:6d:89:0e:c8), Dst: Apple_98:d9:27 (78:4f:43:98:d9:27)
Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.86.68
Transmission Control Protocol, Src Port: 80, Dst Port: 55639, Seq: 0, Ack: 1, Len: 0
    Source Port: 80
    Destination Port: 55639
    [Stream index: 0]
    [TCP Segment Len: 0]
    Sequence Number: 0    (relative sequence number)
    Sequence Number (raw): 1068969752
    [Next Sequence Number: 1    (relative sequence number)]
    Acknowledgment Number: 1    (relative ack number)
    Acknowledgment number (raw): 4236649188
    1010 .... = Header Length: 40 bytes (10)
    Flags: 0x012 (SYN, ACK)
    Window: 28960
    [Calculated window size: 28960]
    Checksum: 0x47b4 [unverified]
    [Checksum Status: Unverified]
    Urgent Pointer: 0
    Options: (20 bytes), Maximum segment size, SACK permitted, Timestamps, No-Operation (NOP), Window scale
        TCP Option - Maximum segment size: 1460 bytes
        TCP Option - SACK permitted
        TCP Option - Timestamps: TSval 3913851370, TSecr 725607509
        TCP Option - No-Operation (NOP)
        TCP Option - Window scale: 7 (multiply by 128)
    [SEQ/ACK analysis]
    [Timestamps]

</code></pre>
<pre><code>Frame 4: 1514 bytes on wire (12112 bits), 1514 bytes captured (12112 bits) on interface en0, id 0
Ethernet II, Src: Apple_98:d9:27 (78:4f:43:98:d9:27), Dst: Google_89:0e:c8 (3c:28:6d:89:0e:c8)
Internet Protocol Version 4, Src: 192.168.86.68, Dst: 128.119.245.12
Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 1, Ack: 1, Len: 1448
    Source Port: 55639
    Destination Port: 80
    [Stream index: 0]
    [TCP Segment Len: 1448]
    Sequence Number: 1    (relative sequence number)
    Sequence Number (raw): 4236649188
    [Next Sequence Number: 1449    (relative sequence number)]
    Acknowledgment Number: 1    (relative ack number)
    Acknowledgment number (raw): 1068969753
    1000 .... = Header Length: 32 bytes (8)
    Flags: 0x010 (ACK)
    Window: 2058
    [Calculated window size: 131712]
    [Window size scaling factor: 64]
    Checksum: 0xbd21 [unverified]
    [Checksum Status: Unverified]
    Urgent Pointer: 0
    Options: (12 bytes), No-Operation (NOP), No-Operation (NOP), Timestamps
        TCP Option - No-Operation (NOP)
        TCP Option - No-Operation (NOP)
        TCP Option - Timestamps: TSval 725607532, TSecr 3913851370
    [SEQ/ACK analysis]
    [Timestamps]
    TCP payload (1448 bytes)
    [Reassembled PDU in frame: 153]
    TCP segment data (1448 bytes)

</code></pre>
<p>Q&amp;As:</p>
<ol>
<li>What is the sequence number of the TCP SYN segment that is used to initiate the TCP connection between the client computer and gaia.cs.umass.edu? (Note: this is the “raw” sequence number carried in the TCP segment itself; it is NOT the packet # in the “No.” column in the Wireshark window.  Remember there is no such thing as a “packet number” in TCP or UDP; as you know, there are sequence numbers in TCP and that’s what we’re after here.  Also note that this is not the relative sequence number with respect to the starting sequence number of this TCP session.). What is it in this TCP segment that identifies the segment as a SYN segment? Will the TCP receiver in this session be able to use Selective Acknowledgments (allowing TCP to function a bit more like a “selective repeat” receiver, see section 3.4.5 in the text)?</li>
</ol>
<p>Sequence Number (raw): 4236649187.</p>
<p>The ‘Flags: 0x002 (SYN)’ identifies the segment as a SYN segment.</p>
<p>Yes, there is an option ‘SACK permitted’.</p>
<ol start="2">
<li>What is the sequence number of the SYNACK segment sent by gaia.cs.umass.edu to the client computer in reply to the SYN? What is it in the segment that identifies the segment as a SYNACK segment? What is the value of the Acknowledgement field in the SYNACK segment? How did gaia.cs.umass.edu determine that value?</li>
</ol>
<p>Sequence Number (raw): 1068969752</p>
<p>Flags: 0x012 (SYN, ACK) identifies the segment as a SYNACK segment.</p>
<p>Acknowledgment number (raw): 4236649188</p>
<p>Ack = Seq<sub>(peer)</sub> + 1.</p>
<ol start="3">
<li>What is the sequence number of the TCP segment containing the header of the HTTP POST command?  Note that in order to find the POST message header, you’ll need to dig into the packet content field at the bottom of the Wireshark window, looking for a segment with the ASCII text “POST” within its DATA field , .  How many bytes of data are contained in the payload (data) field of this TCP segment? Did all of the data in the transferred file alice.txt fit into this single segment?</li>
</ol>
<p>Sequence Number (raw): 4236649188.</p>
<p>TCP payload (1448 bytes).</p>
<p>No.</p>
<ol start="4">
<li>Consider the TCP segment containing the HTTP “POST” as the first segment in the data transfer part of the TCP connection.<br/>
•	At what time was the first segment (the one containing the HTTP POST) in the
data-transfer part of the TCP connection sent?</li>
</ol>
<p>0.024047s.</p>
<p>•	At what time was the ACK for this first data-containing segment received?</p>
<p>0.052671s.</p>
<p>•	What is the RTT for this first data-containing segment?</p>
<p>[The RTT to ACK the segment was: 0.028624000 seconds]</p>
<p>•	What is the RTT value the second data-carrying TCP segment and its ACK?</p>
<p>[The RTT to ACK the segment was: 0.028628000 seconds]</p>
<p>•	What is the EstimatedRTT value (see Section 3.5.3, in the text) after the ACK for the second data-carrying segment is received? Assume that in making this calculation after the received of the ACK for the second segment, that the initial value of EstimatedRTT is equal to the measured RTT for the first segment, and then is computed using the EstimatedRTT equation on page 242, and a value of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> = 0.125.
Note: Wireshark has a nice feature that allows you to plot the RTT for each of the TCP segments sent.  Select a TCP segment in the “listing of captured packets” window that is being sent from the client to the gaia.cs.umass.edu server.  Then select: Statistics<span>→</span>TCP Stream Graph<span>→</span>Round Trip Time Graph.</p>
<pre><code># mesured RTT for these two packets.
[The RTT to ACK the segment was: 0.028624000 seconds]
[The RTT to ACK the segment was: 0.028628000 seconds]```
</code></pre>
<p>EstimatedRTT = (1 – α) • EstimatedRTT + α • SampleRTT</p>
<p>So EstimatedRTT is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.875</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.028624000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.125</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.028628000</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.02862449</span><span class="mord mathnormal">s</span></span></span></span>.</p>
<ol start="5">
<li>What is the length (header plus payload) of each of the first four data-carrying TCP segments?</li>
</ol>
<pre><code>Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 1, Ack: 1, Len: 1448
    TCP segment data (1448 bytes)
</code></pre>
<p>1448 Bytes.</p>
<ol start="6">
<li>What is the minimum amount of available buffer space advertised to the client by gaia.cs.umass.edu among these first four data-carrying TCP segments ?  Does the lack of receiver buffer space ever throttle the sender for these first four data-carrying segments?</li>
</ol>
<pre><code>[Calculated window size: 31872]
[Calculated window size: 34816]
[Calculated window size: 37760]
[Calculated window size: 40576]
</code></pre>
<p>The lack of receiver buffer space <strong>never</strong> throttle the sender for these first four data-carrying segments</p>
<ol start="7">
<li>Are there any retransmitted segments in the trace file? What did you check for (in the trace) in order to answer this question?</li>
</ol>
<p>In the TimeSequence-Graph (Stevens) of this trace (if it’s a straight line, click the reset direction button), all sequence numbers are incresing monotonically.</p>
<ol start="8">
<li>How much data does the receiver typically acknowledge in an ACK among the first ten data-carrying segments sent from the client to gaia.cs.umass.edu?  Can you identify cases where the receiver is ACKing every other received segment (see Table 3.2 in the text) among these first ten data-carrying segments?</li>
</ol>
<p>1448 bytes, No.8 packet Ack=2897, and No.7 Ack=1449, it is Acking 1448 bytes.</p>
<ol start="9">
<li>What is the throughput (bytes transferred per unit time) for the TCP connection?  Explain how you calculated this value.</li>
</ol>
<p>The last Ack is 153426, time is 0.191496s, and the first data carrying packet’s time is 0.024047, so <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">ban</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">153426</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">0.191496</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.024047</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">916255</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord">/</span><span class="mord mathnormal">s</span></span></span></span></p>
<ol start="10">
<li>Use the Time-Sequence-Graph(Stevens) plotting tool to view the sequence number versus time plot of segments being sent from the client to the gaia.cs.umass.edu server.  Consider the “fleets” of packets sent around t = 0.025, t = 0.053, t = 0.082 and t = 0.1. Comment on whether this looks as if TCP is in its slow start phase, congestion avoidance phase or some other phase. Figure 6 shows a slightly different view of this data.</li>
</ol>
<p>Yes, in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.025</span></span></span></span> about 4 packets received, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.053</span></span></span></span> about 6 packets received, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.082</span></span></span></span> about 12 packets received, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span> about 24 packets received, It is ‘slow start’ mechanism of TCP, the window size grows up exponentially.</p>
<ol start="11">
<li>These “fleets” of segments appear to have some periodicity. What can you say about the period?</li>
</ol>
<p>The period is close to the RTT, because the TCP need a RTT time at averange to calculate the new Esitimated RTT and decides how many packets will be sent.</p>
<h2 id="udp">UDP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#udp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="trigger-udp-packets-through-nslookup">Trigger UDP packets through nslookup<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#trigger-udp-packets-through-nslookup" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Captured data:</p>
<p>Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file dns-wireshark-trace1-1 in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" class="external">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<ol>
<li>Select the first UDP segment in your trace. What is the packet number  of this segment in the trace file?  What type of application-layer payload or protocol message is being carried in this UDP segment?  Look at the details of this packet in Wireshark.  How many fields there are in the UDP header? (You shouldn’t look in the textbook! Answer these questions directly from what you observe in the packet trace.) What are the names of these fields?</li>
</ol>
<pre><code>User Datagram Protocol, Src Port: 47931, Dst Port: 1900
    Source Port: 47931
    Destination Port: 1900
    Length: 283
    Checksum: 0xf7a8 [unverified]
    [Checksum Status: Unverified]
    [Stream index: 0]
    [Timestamps]
        [Time since first frame: 0.000000000 seconds]
        [Time since previous frame: 0.000000000 seconds]
    UDP payload (275 bytes)

</code></pre>
<p>5th, SSDP(Simple Service Discovery Protocol), There are 4 fields in UDP Header: Source Port, Destination Port, Length, Checksum.</p>
<ol start="2">
<li>By consulting the displayed information in Wireshark’s packet content field for this packet (or by consulting the textbook), what is the length (in bytes) of each of the UDP header fields?</li>
</ol>
<p>Through observation, length of each field is 2 bytes.</p>
<ol start="3">
<li>The value in the Length field is the length of what? (You can consult the text for this answer). Verify your claim with your captured UDP packet.</li>
</ol>
<p>The value of the length field is 283, which is  (UDP payload (275 bytes) + Header length(8 bytes) ).</p>
<ol start="4">
<li>What is the maximum number of bytes that can be included in a UDP payload?  (Hint: the answer to this question can be determined by your answer to 2. above)</li>
</ol>
<p>The Maximum value of length field is 0xFFFF(65535 in decimal), so maximum bytes of payload is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">65535</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">65527</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span></span></span></span>.</p>
<ol start="5">
<li>What is the largest possible source port number? (Hint: see the hint in 4.)</li>
</ol>
<p>It is 65535.</p>
<ol start="6">
<li>What is the protocol number for UDP? Give your answer in decimal notation. To answer this question, you’ll need to look into the Protocol field of the IP datagram containing this UDP segment (see Figure 4.13 in the text, and the discussion of IP header fields).</li>
</ol>
<pre><code>Internet Protocol Version 4, Src: 10.0.0.254, Dst: 239.255.255.250
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)
    Total Length: 303
    Identification: 0xa1c3 (41411)
    Flags: 0x40, Don't fragment
    Fragment Offset: 0
    Time to Live: 4
    Protocol: UDP (17)
    Header Checksum: 0xd902 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.0.0.254
    Destination Address: 239.255.255.250

</code></pre>
<p>It is 17.</p>
<ol start="7">
<li>Examine the pair of UDP packets in which your host sends the first UDP packet and the second UDP packet is a reply to this first UDP packet. (Hint: for a second packet to be sent in response to a first packet, the sender of the first packet should be the destination of the second packet).  What is the packet number  of the first of these two UDP segments in the trace file?  What is the packet number  of the second of these two UDP segments in the trace file? Describe the relationship between the port numbers in the two packets.</li>
</ol>
<pre><code>request:
User Datagram Protocol, Src Port: 58350, Dst Port: 53
    Source Port: 58350
    Destination Port: 53
    Length: 43
    Checksum: 0xc31d [unverified]
    [Checksum Status: Unverified]
    [Stream index: 1]
    [Timestamps]
        [Time since first frame: 0.000000000 seconds]
        [Time since previous frame: 0.000000000 seconds]
    UDP payload (35 bytes)

response:
User Datagram Protocol, Src Port: 53, Dst Port: 58350
    Source Port: 53
    Destination Port: 58350
    Length: 59
    Checksum: 0x4af2 [unverified]
    [Checksum Status: Unverified]
    [Stream index: 1]
    [Timestamps]
        [Time since first frame: 0.023908000 seconds]
        [Time since previous frame: 0.023908000 seconds]
    UDP payload (51 bytes)


</code></pre>
<p>The destination port of the response packet is same as the request packet’s source port, reverse is also true.</p>
<h2 id="ip">IP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ip" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="capturing-packets-from-an-execution-of-traceroute">Capturing packets from an execution of traceroute<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#capturing-packets-from-an-execution-of-traceroute" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Captured data:</p>
<p>Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file ip-wireshark-trace1-1.pcapng in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" class="external">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h4 id="part-1-basic-ipv4">Part 1: Basic IPv4<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#part-1-basic-ipv4" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ol>
<li>Select the first UDP segment sent by your computer via the traceroute command to gaia.cs.umass.edu. (Hint: this is 44th packet in the trace file in the ip-wireshark-trace1-1.pcapng file in footnote 2). Expand the Internet Protocol part of the packet in the packet details window.  What is the IP address of your computer?</li>
</ol>
<pre><code>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)
    Total Length: 56
    Identification: 0xfda1 (64929)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 1
    Protocol: UDP (17)
    Header Checksum: 0x2faa [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.86.61
    Destination Address: 128.119.245.12

</code></pre>
<p>IP of local computer is 192.168.86.61 .</p>
<ol start="2">
<li>What is the value in the time-to-live (TTL) field in this IPv4 datagram’s header?</li>
</ol>
<p>1 .</p>
<ol start="3">
<li>What is the value in the upper layer protocol field in this IPv4 datagram’s header? [Note: the answers for Linux/MacOS differ from Windows here].</li>
</ol>
<p>Protocol: UDP (17).</p>
<ol start="4">
<li>How many bytes are in the IP header?</li>
</ol>
<p>… 0101 = Header Length: 20 bytes (5).</p>
<ol start="5">
<li>How many bytes are in the payload of the IP datagram?  Explain how you determined the number of payload bytes.</li>
</ol>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">He</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">56</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">36</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span></span></span></span></p>
<ol start="6">
<li>Has this IP datagram been fragmented?  Explain how you determined whether or not the datagram has been fragmented.</li>
</ol>
<p>No, if it is fragmented, the payload length of IP layer should be less than the Length of upper layer.</p>
<ol start="7">
<li>Which fields in the IP datagram always change from one datagram to the next within this series of UDP segments sent by your computer destined to 128.119.245.12, via traceroute?  Why?</li>
</ol>
<p>TTL and destination port, because traceroute set the TTL to n to trigger a ICMP response packet (ttl exceeded) on the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> hot of the route of the packet. destination port is used to track the coresponding response of each packet.</p>
<ol start="8">
<li>Which fields in this sequence of IP datagrams (containing UDP segments) stay constant? Why?</li>
</ol>
<p>The destination IP and the source port/IP, because the function of traceroute is to trace the route between the source IP and a specific destination IP.</p>
<ol start="9">
<li>Describe the pattern you see in the values in the Identification field of the IP datagrams being sent by your computer.</li>
</ol>
<p>Plus 1 after every packet sent.</p>
<ol start="10">
<li>What is the upper layer protocol specified in the IP datagrams returned from the routers? [Note: the answers for Linux/MacOS differ from Windows here].</li>
</ol>
<pre><code>Internet Protocol Version 4, Src: 192.168.86.1, Dst: 192.168.86.61
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated Services Field: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    Total Length: 84
    Identification: 0x6889 (26761)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 64
    Protocol: ICMP (1)
    Header Checksum: 0xe3d0 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.86.1
    Destination Address: 192.168.86.61

</code></pre>
<p>Protocol: ICMP (1).</p>
<ol start="11">
<li>Are the values in the Identification fields (across the sequence of all of ICMP packets from all of the routers) similar in behavior to your answer to question 9 above?</li>
</ol>
<p>Yes.</p>
<ol start="12">
<li>Are the values of the TTL fields similar, across all of ICMP packets from all of the routers?</li>
</ol>
<p>All equals to 1.</p>
<h4 id="part-2-fragmentation">Part 2: Fragmentation<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#part-2-fragmentation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ol start="14">
<li>What information in the IP header indicates that this datagram been fragmented?</li>
</ol>
<pre><code>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)
    Total Length: 1500
    Identification: 0xfda2 (64930)
    Flags: 0x20, More fragments
        0... .... = Reserved bit: Not set
        .0.. .... = Don't fragment: Not set
        ..1. .... = More fragments: Set
    Fragment Offset: 0
    Time to Live: 1
    Protocol: UDP (17)
    Header Checksum: 0x0a05 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.86.61
    Destination Address: 128.119.245.12
    [Reassembled IPv4 in frame: 181]
</code></pre>
<p>Flags: 0x20, More fragments.</p>
<ol start="15">
<li>What information in the IP header for this packet indicates whether this is the first fragment versus a latter fragment?</li>
</ol>
<p>Fragment Offset: 0 indicates it is the first fragment, offset is non-zero value indicates it is a latter fragment.</p>
<ol start="16">
<li>How many bytes are there in is this IP datagram (header plus payload)?</li>
</ol>
<p>Total Length: 1500.</p>
<ol start="17">
<li>Now inspect the datagram containing the second fragment of the fragmented UDP segment. What information in the IP header indicates that this is not the first datagram fragment?</li>
</ol>
<p>Fragment Offset: 1480.</p>
<ol start="18">
<li>What fields change in the IP header between the first and second fragment?</li>
</ol>
<p>Fragment Offset and Header checksum.</p>
<ol start="19">
<li>Now find the IP datagram containing the third fragment of the original UDP segment. What information in the IP header indicates that this is the last fragment of that segment?</li>
</ol>
<pre><code>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)
    Total Length: 40
    Identification: 0xfda2 (64930)
    Flags: 0x01
        0... .... = Reserved bit: Not set
        .0.. .... = Don't fragment: Not set
        ..0. .... = More fragments: Not set
    Fragment Offset: 2960
</code></pre>
<p>Flags: 0x01, ..0. … = More fragments: Not set.</p>
<h3 id="capturing-ipv6-packets">Capturing IPV6 packets<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#capturing-ipv6-packets" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Captured data:</p>
<p>Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file  ip-wireshark-trace2-1.pcapng in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" class="external">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h4 id="part-3-ipv6">Part 3: IPv6<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#part-3-ipv6" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Let’s start by taking a closer look at the 20th packet in this trace, sent at t=3.814489.  This is a DNS request (contained in an IPv6 datagram) to an IPv6 DNS server for the IPv6 address of youtube.com.</p>
<ol start="20">
<li>What is the IPv6 address of the computer making the DNS AAAA request?  This is the source address of the 20th packet in the trace. Give the IPv6 source address for this datagram in the exact same form as displayed in the Wireshark window .</li>
</ol>
<pre><code>Internet Protocol Version 6, Src: 2601:193:8302:4620:215c:f5ae:8b40:a27a, Dst: 2001:558:feed::1
    0110 .... = Version: 6
    .... 0000 0000 .... .... .... .... .... = Traffic Class: 0x00 (DSCP: CS0, ECN: Not-ECT)
    .... .... .... 0110 0011 1110 1101 0000 = Flow Label: 0x63ed0
    Payload Length: 37
    Next Header: UDP (17)
    Hop Limit: 255
    Source Address: 2601:193:8302:4620:215c:f5ae:8b40:a27a
    Destination Address: 2001:558:feed::1

</code></pre>
<p>2601:193:8302:4620:215c:f5ae:8b40:a27a</p>
<ol start="21">
<li>What is the IPv6 destination address for this datagram? Give this IPv6 address in the exact same form as displayed in the Wireshark window.</li>
</ol>
<p>2001:558:feed::1</p>
<ol start="22">
<li>What is the value of the flow label for this datagram?</li>
</ol>
<p>… … … 0110 0011 1110 1101 0000 = Flow Label: 0x63ed0</p>
<ol start="23">
<li>How much payload data is carried in this datagram?</li>
</ol>
<p>Payload Length: 37</p>
<ol start="24">
<li>What is the upper layer protocol to which this datagram’s payload will be delivered at the destination?</li>
</ol>
<p>Next Header: UDP (17)</p>
<p>Lastly,  find the IPv6 DNS response to the IPv6 DNS AAAA request made in the 20th packet in this trace.  This DNS response contains IPv6 addresses for youtube.com.</p>
<ol start="25">
<li>How many IPv6 addresses are returned in the response to this AAAA request?</li>
</ol>
<pre><code>Domain Name System (response)
    Transaction ID: 0x920d
    Flags: 0x8180 Standard query response, No error
    Questions: 1
    Answer RRs: 1
    Authority RRs: 0
    Additional RRs: 0
    Queries
    Answers
        youtube.com: type AAAA, class IN, addr 2607:f8b0:4006:815::200e
    [Request In: 20]
    [Time: 0.140916000 seconds]

</code></pre>
<p>Only one.</p>
<ol start="26">
<li>What is the first of the IPv6 addresses returned by the DNS for youtube.com (in the ip-wireshark-trace2-1.pcapng trace file, this is also the address that is numerically the smallest)? Give this IPv6 address in the exact same shorthand form as displayed in the Wireshark window.</li>
</ol>
<p>2607:f8b0:4006:815::200e.</p>
<h2 id="nat">NAT<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nat" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="capturing-packets-from-an-execution-of-traceroute-1">Capturing packets from an execution of traceroute<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#capturing-packets-from-an-execution-of-traceroute-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Captured data:</p>
<p>Answer the following questions, either from your own live trace, or by opening the Wireshark captured packet trace file nat-inside-wireshark-trace1-1.pcapng and nat-outside-wireshark-trace1-1.pcapng in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" class="external">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>Let’s first take a look at what’s happening on the LAN side of the NAT router. Open the nat-inside-wireshark-trace1-1.pcapng trace file. In this file, you should see an HTTP GET request addressed to the external web server at IP address 138.76.29.8, as well as the subsequent HTTP response message (“200 OK”). Both of these messages in the trace file were captured on the LAN side of the router.</p>
<ol>
<li>What is the IP address of the client that sends the HTTP GET request in the nat-inside-wireshark-trace1-1.pcapng trace? What is the source port number of the TCP segment in this datagram containing the HTTP GET request? What is the destination IP address of this HTTP GET request? What is the destination port number of the TCP segment in this datagram containing the HTTP GET request?</li>
</ol>
<p>Internet Protocol Version 4, Src: 192.168.10.11, Dst: 138.76.29.8</p>
<p>Transmission Control Protocol, Src Port: 53924, Dst Port: 80, Seq: 1, Ack: 1, Len: 330</p>
<ol start="2">
<li>At what time  is the corresponding HTTP 200 OK message from the webserver forwarded by the NAT router to the client on the router’s LAN side?</li>
</ol>
<p>[Time since first frame in this TCP stream: 0.030672101 seconds]
.</p>
<ol start="3">
<li>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP 200 OK message?</li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 192.168.10.11</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924, Seq: 1, Ack: 331, Len: 547</p>
<p>In the following we’ll focus on these two HTTP messages (GET and 200 OK). Our goal below will be to locate these two HTTP messages in the trace file nat-outside-wireshark-trace1-1.pcapng, captured on the Internet-side link between the router and the ISP. Because the captured packets heading towards the server will have already been forwarded through the NAT router, some of the IP address and port numbers will have been changed as a result of NAT translation.</p>
<p>Open the trace file nat-outside-wireshark-trace1-1.pcapng. Note that the time stamps in this file and the nat-inside-wireshark-trace1-1.pcapng file are not necessarily synchronized.</p>
<p>In the nat-outside-wireshark-trace1-1.pcapng trace file, find the HTTP GET message that corresponds to the HTTP GET message that was sent from the client to the 138.76.29.8 server at time t=0.27362245, where t=0.27362245 is the time at which this message was sent, as recorded in the nat-inside-wireshark-trace1-1.pcapng trace file.<br/>
4.	At what time does this HTTP GET message appear in the nat-outside-wireshark-trace1-1.pcapng trace file?</p>
<p>[Time since first frame in this TCP stream: 0.027356291 seconds]
.</p>
<ol start="5">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying this HTTP GET (as recorded in the nat-outside-wireshark-trace1-1.pcapng trace file)?</li>
</ol>
<p>Internet Protocol Version 4, Src: 10.0.1.254, Dst: 138.76.29.8
Transmission Control Protocol, Src Port: 53924, Dst Port: 80, Seq: 1, Ack: 1, Len: 330</p>
<ol start="6">
<li>Which of these four fields are different than in your answer to question 1 above?</li>
</ol>
<p>The source IP changed.</p>
<ol start="7">
<li>Are any fields in the HTTP GET message changed?</li>
</ol>
<p>None.</p>
<ol start="8">
<li>Which of the following fields in the IP datagram carrying the HTTP GET are changed from the datagram received on the local area network (inside) to the corresponding datagram forwarded on the Internet side (outside) of the NAT router: Version, Header Length, Flags, Checksum?</li>
</ol>
<p>Checksum changed.</p>
<p>Let’s continue to look at the nat-outside-wireshark-trace1-1.pcapng trace file. Find the HTTP reply containing the “200 OK” message that was received in response to the HTTP GET request you just examined in questions 4-8 above.</p>
<ol start="9">
<li>At what time does this message appear in the nat-outside-wireshark-trace1-1.pcapng trace file?</li>
</ol>
<p>[Time since first frame in this TCP stream: 0.030625966 seconds]
.</p>
<ol start="10">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying this HTTP reply (“200 OK”) message (as recorded in the nat-outside-wireshark-trace1-1.pcapng trace file)?</li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 10.0.1.254</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924, Seq: 1, Ack: 331, Len: 547</p>
<p>Lastly, let’s consider what happens when the NAT router receives this datagram that you examined in questions 9 and 10, performs NAT translation, and finally forwards that datagram to the destination host on the LAN side. Based on your answers to questions 1 through 10 above and your knowledge of how NAT works, you should be able to answer the following question without actually looking at the nat-inside-wireshark-trace1-1.pcapng trace file:</p>
<ol start="11">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying the HTTP reply (“200 OK”) that is forwarded from the router to the destination host in the right of Figure 1?</li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 192.168.10.11</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924</p>
<h2 id="dhcp">DHCP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dhcp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h2 id="icmp">ICMP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#icmp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h2 id="ethernet-and-arp">Ethernet and ARP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ethernet-and-arp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h2 id="80211-wifi">802.11 WiFi<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#80211-wifi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h2 id="ssl-currently-being-updated-to-tls">SSL (currently being updated to TLS)<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ssl-currently-being-updated-to-tls" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h2 id="ip-1">IP<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ip-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h1 id="refs">Refs<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#refs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<div id="refer-anchor-1"></div>
- [1] [Umass Wireshark labs](https://gaia.cs.umass.edu/kurose_ross/wireshark.php)</article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#intruduction" data-for="intruduction">intruduction</a></li><li class="depth-0"><a href="#experiments" data-for="experiments">Experiments</a></li><li class="depth-1"><a href="#basic-skill-capturing-packets-using-wireshark" data-for="basic-skill-capturing-packets-using-wireshark">Basic skill: capturing packets using Wireshark</a></li><li class="depth-1"><a href="#http" data-for="http">HTTP</a></li><li class="depth-2"><a href="#the-basic-http-getresponse-interaction" data-for="the-basic-http-getresponse-interaction">The Basic HTTP GET/response interaction</a></li><li class="depth-2"><a href="#the-http-conditional-getresponse-interaction" data-for="the-http-conditional-getresponse-interaction">The HTTP CONDITIONAL GET/response interaction</a></li><li class="depth-2"><a href="#retrieving-long-documents" data-for="retrieving-long-documents">Retrieving Long Documents</a></li><li class="depth-2"><a href="#html-documents-with-embedded-objects" data-for="html-documents-with-embedded-objects">HTML Documents with Embedded Objects</a></li><li class="depth-2"><a href="#http-authentication" data-for="http-authentication">HTTP Authentication</a></li><li class="depth-1"><a href="#dns" data-for="dns">DNS</a></li><li class="depth-2"><a href="#trace-dns-from-web-browser" data-for="trace-dns-from-web-browser">Trace DNS from web browser</a></li><li class="depth-2"><a href="#trace-dns-from-nslookup" data-for="trace-dns-from-nslookup">Trace DNS from nslookup</a></li><li class="depth-2"><a href="#trace-dns-from-nslookup-with-ns-type-record" data-for="trace-dns-from-nslookup-with-ns-type-record">Trace DNS from nslookup with NS type record</a></li><li class="depth-1"><a href="#tcp" data-for="tcp">TCP</a></li><li class="depth-2"><a href="#upload-a-150-kb-file" data-for="upload-a-150-kb-file">Upload a 150+ KB file</a></li><li class="depth-1"><a href="#udp" data-for="udp">UDP</a></li><li class="depth-2"><a href="#trigger-udp-packets-through-nslookup" data-for="trigger-udp-packets-through-nslookup">Trigger UDP packets through nslookup</a></li><li class="depth-1"><a href="#ip" data-for="ip">IP</a></li><li class="depth-2"><a href="#capturing-packets-from-an-execution-of-traceroute" data-for="capturing-packets-from-an-execution-of-traceroute">Capturing packets from an execution of traceroute</a></li><li class="depth-2"><a href="#capturing-ipv6-packets" data-for="capturing-ipv6-packets">Capturing IPV6 packets</a></li><li class="depth-1"><a href="#nat" data-for="nat">NAT</a></li><li class="depth-2"><a href="#capturing-packets-from-an-execution-of-traceroute-1" data-for="capturing-packets-from-an-execution-of-traceroute-1">Capturing packets from an execution of traceroute</a></li><li class="depth-1"><a href="#dhcp" data-for="dhcp">DHCP</a></li><li class="depth-1"><a href="#icmp" data-for="icmp">ICMP</a></li><li class="depth-1"><a href="#ethernet-and-arp" data-for="ethernet-and-arp">Ethernet and ARP</a></li><li class="depth-1"><a href="#80211-wifi" data-for="80211-wifi">802.11 WiFi</a></li><li class="depth-1"><a href="#ssl-currently-being-updated-to-tls" data-for="ssl-currently-being-updated-to-tls">SSL (currently being updated to TLS)</a></li><li class="depth-1"><a href="#ip-1" data-for="ip-1">IP</a></li><li class="depth-0"><a href="#refs" data-for="refs">Refs</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.1.6</a>, © 2024</p><ul><li><a href="https://github.com/XiGou">GitHub</a></li><li><a href="https://linkedin.com/in/xigou">Linkedin</a></li><li><a href="https://stackoverflow.com/users/10871150/xi-gou">StackOverflow</a></li><li><a href="mailto:gouxivae@gmail.com">Email</a></li></ul></footer></div></body><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function o(){let e=this.parentElement;e.classList.toggle("is-collapsed");let l=e.classList.contains("is-collapsed")?this.scrollHeight:e.scrollHeight;e.style.maxHeight=l+"px";let c=e,t=e.parentElement;for(;t;){if(!t.classList.contains("callout"))return;let n=t.classList.contains("is-collapsed")?t.scrollHeight:t.scrollHeight+c.scrollHeight;t.style.maxHeight=n+"px",c=t,t=t.parentElement}}function i(){let e=document.getElementsByClassName("callout is-collapsible");for(let s of e){let l=s.firstElementChild;if(l){l.removeEventListener("click",o),l.addEventListener("click",o);let t=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=t+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
          const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
          mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: darkMode ? 'dark' : 'default'
          });
          document.addEventListener('nav', async () => {
            await mermaid.run({
              querySelector: '.mermaid'
            })
          });
          </script><script src="https://www.googletagmanager.com/gtag/js?id=G-4FDRZXCQ8S" type="application/javascript"></script><script src="../postscript.js" type="module"></script></html>